/*
    app interface components, 5002
    v2018.10.21
*/

/* ------------------------------------ screen sizes */

$screenMaxSizeForMobile:    600px;
$screenMaxSizeForTablet:    900px;
$screenMaxSizeForXS:       1100px;
$screenMaxSizeForS:        1300px;
$screenMaxSizeForM:        1400px;
$screenMaxSizeForL:        1800px;

$screenForAll:      "min-width: 0px";
$screenForXL:       "min-width: #{$screenMaxSizeForL + 1}";
$screenForL:        "max-width: #{$screenMaxSizeForL}";
$screenNotL:        "min-width: #{$screenMaxSizeForL + 1}";
$screenForM:        "max-width: #{$screenMaxSizeForM}";
$screenNotM:        "min-width: #{$screenMaxSizeForM + 1}";
$screenForS:        "max-width: #{$screenMaxSizeForS}";
$screenNotS:        "min-width: #{$screenMaxSizeForS + 1}";
$screenForXS:       "max-width: #{$screenMaxSizeForXS}";
$screenNotXS:       "min-width: #{$screenMaxSizeForXS + 1}";
$screenForTablet:   "max-width: #{$screenMaxSizeForTablet}";
$screenNotTablet:   "min-width: #{$screenMaxSizeForTablet + 1}";
$screenForMobile:   "max-width: #{$screenMaxSizeForMobile}";
$screenNotMobile:   "min-width: #{$screenMaxSizeForMobile + 1}";

/* ------------------------------------ font */

$fontSizeSmaller: 0.8em; // deprecated

/* ------------------------------------ other settings */

$margin-def: 2.4rem;
$width--text-column:  64rem;
$width--aside-column: 32rem;

/* ------------------------------------ tools */

@mixin contentbox--xy-centered {
    display: flex;
    justify-content: center;
    align-items: center;
    align-content: center;
}
@mixin contentbox--y-centered {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    align-content: center;
}
@mixin has-illustrated-background {
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center center;
}


/* ------------------------------------ grid */

$grid_formula--main:
    unquote(" [main-start] ")
        minmax( 0, $width--text-column )
    unquote(" [main-end] ");

$grid_formula--aside:
    unquote(" [aside-start] ")
        minmax( 0, $width--aside-column )
    unquote(" [aside-end] ");

$grid_formula--menu:
    unquote(" [menu-start] ")
        minmax( 0, $width--aside-column )
    unquote(" [menu-end] ");

$grid_formula--overmain:
    unquote(" [overmain-start] ")
        $margin-def
            $grid_formula--main
        $margin-def
    unquote(" [overmain-end] ");

$grid_formula--full__content:
    unquote(" [full-start] ")
        minmax( 0, 1fr )
            $grid_formula--overmain
        minmax( 0, 1fr )
    unquote(" [full-end] ");

$grid_formula--full__article:
    unquote(" [full-start] ")
        minmax( 0, 1fr )
            $grid_formula--overmain
                $margin-def
            $grid_formula--aside
        minmax( 0, 1fr )
    unquote(" [full-end] ");

$grid_formula--full__page:
    unquote(" [full-start] ")
        minmax( 0, 1fr )
            $grid_formula--menu
                $margin-def
            $grid_formula--overmain
                $margin-def
            $grid_formula--aside
        minmax( 0, 1fr )
    unquote(" [full-end] ");

$grid_cell--merge__article: overmain / span 5;

%grid_layout--base {
    display: grid;
    grid-auto-rows: min-content;
    grid-auto-flow: row;
    grid-template-columns: $grid_formula--overmain;
    @supports (grid-gap:$margin-def) {
        grid-gap: $margin-def 0;
        &>*:not([layer]):not(.layer) {
            margin-top: 0;
            margin-bottom: 0;
        }
    }
    &>* { grid-column: main; }
    &>[layer], &>.layer { grid-column: full; }
    &>[block], &>.block { grid-column: overmain; }
}
%grid_layout--content {
    @extend %grid_layout--base;
    grid-template-columns: $grid_formula--full__content;
}
%grid_layout--article {
    @extend %grid_layout--content;
    @media ($screenNotTablet) {
        grid-template-columns: $grid_formula--full__article;
        &>[wrap-row], &>.wrap-row { grid-column: $grid_cell--merge__article; }
        &>[wrap-sidenote], &>.wrap-sidenote { grid-column: aside; }
    }
}
%grid_layout--page {
    @extend %grid_layout--content;
    @media ($screenNotTablet) {
        grid-template-columns: $grid_formula--full__page;
        &>[wrap-row], &>.wrap-row  { grid-column: 2 / span 6; }
        &>[role-menu], &>.role-menu { grid-column: menu; }
    }
}
.layer {
    @extend %grid_layout--content;
    grid-template-columns: inherit;
}
.block {
    @extend %grid_layout--base;
}
.wrap-sidenote {
    @extend %grid_layout--base;
    @media ($screenNotTablet) {
        grid-column: aside;
    }
    @media ($screenForTablet) {
        grid-column: full;
        grid-template-columns: $grid_formula--full__content;
    }

    /* sidenote`s height absolute solution */

    @media ($screenNotTablet) {
        position: relative;
        overflow: visible;
        [note], .note {
            position: absolute;
            top:0;
            left:0;
            right:0;
        }
    }
    /*@media ($screenForTablet) {
        [note], .note {
            grid-template-columns: $grid_formula--full__content;
            grid-column: full;
        }
    }*/
}
.wrap-row {
    //@extend %grid_layout--content;
    grid-column: overmain;
    grid-template-columns: inherit;
    background-color: pink;
}
.wrap-two-columns {
    display: grid;
    grid-template-columns: auto auto;
    grid-gap: 0 $margin-def;
    &>*{
        grid-column: auto;
        margin-top: 0;
        margin-bottom: 0;
    }
}
/* ------------------------------------ modifiers */

.bg {
    @include has-illustrated-background;
    background-color: rgba(0,0,0,0.1);
    padding-bottom: $margin-def;

    padding-top: $margin-def;
    &>[illustration]:first-child,
    &>.illustration:first-child {
        margin-top: -$margin-def;
    }
}
.is-centered {
    justify-content: center;
    text-align: center;
}

/* ------------------------------------ components */

.illustration {
    @extend .block;
    padding-top: 0;
    &>*{ grid-column: overmain; }
    figcaption { grid-column: main; }
}
.note {
    grid-column: overmain;
    @media ($screenForTablet) {
        grid-template-columns: $grid_formula--full__content;
        grid-column: full;
    }
    @media ($screenNotMobile) {
        font-size: 0.8em;
    }
}
.textnote {
    @extend .block;
    @extend .note;
    @media ($screenNotMobile) {
        padding-top: 0.25em; // horizontal baseline
    }
}

/* ------------------------------------ layer templates */

.layout-for-markup {  @extend %grid_layout--content; }
.layout-for-article { @extend %grid_layout--article; }
.layout-for-page {    @extend %grid_layout--page; }

/* ------------------------------------ pending */


[role-columns], .role-columns {
    display: grid;
    grid-template-columns: auto auto;
    grid-gap: 0 $margin-def;
    &>*{ grid-column: auto; }
    &[format-ab],  &.format-ab, { grid-template-columns: 1fr 1fr; }
    &[format-abc], &.format-abc { grid-template-columns: 1fr 1fr 1fr; }
    &[format-aab], &.format-abc { grid-template-columns: 2fr 1fr 1fr; }
}


[role-menu], .role-menu {
    @extend %grid_layout--base;
    @media ($screenNotTablet) { grid-column: menu; }
    @media ($screenForTablet) {
        grid-column: full;
        grid-template-columns: $grid_formula--full__content;
    }
}





/* ------------------------------------ REMOVED */


.content-layout {
    @extend .layout-for-markup;
}
.article-layout {
    @extend .layout-for-article;

}
.page-layout {
    @extend .layout-for-page;
}

/* ------------------------------------ eof interface */

